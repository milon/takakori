name: Check & Fix Style

on:
  push

jobs:
    pint:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
              with:
                ref: master
                fetch-depth: 0
            - name: Set up PHP 8.4
              uses: shivammathur/setup-php@v2
              with:
                php-version: 8.4
                tools: composer:v2
            - name: Install Composer Dependencies
              run: composer install --no-ansi --no-interaction --ignore-platform-reqs --no-scripts --no-suggest --no-progress --prefer-dist
            - name: Run Pint
              run: composer pint
            - name: Commit files
              run: |
                git config --local user.email "actions@github.com"
                git config --local user.name "GitHub Actions"
                if [ -n "$(git status --porcelain)" ]; then
                    git commit -am "Fix style with laravel-pint in GitHub Actions"
                    git push
                else
                    echo "No changes to commit"
                fi  
